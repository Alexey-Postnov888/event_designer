# **Функциональные требования**

**1\. Веб-конструктор мероприятий (Frontend)**

**ВИ1: Авторизация администратора**

**Предусловие:**  
Пользователь открывает веб-приложение конструктора мероприятий.

**Основной сценарий:**

1.  Пользователь вводит логин и пароль в форме авторизации.
2.  Система отправляет введённые данные в Backend для проверки.
3.  При успешной проверке пользователю предоставляется доступ к панели управления мероприятиями.

**Альтернативные сценарии:**

1.  Если данные неверны - система отображает сообщение об ошибке.
2.  При повторном вводе система повторяет проверку до успешного результата.

**Механика авторизации в системе**

**1.1. Авторизация в веб-конструкторе (админка)**

Используется **логин + пароль**, заранее выданные администраторам компанией.

**Процесс:**

1.  Админ открывает сайт.
2.  Вводит email и пароль.
3.  Фронтенд отправляет запрос POST /admin/login → Бэкенд.
4.  Бэкенд:

- ищет пользователя в БД среди админов,
- сравнивает пароль (хэш),
- выдает JWT/токен.

1.  Админ получает доступ к:

- созданию мероприятий,
- редактированию,
- публикации,
- выдаче ссылки на лендинг.

**Доступ к сайту только админы**  
Пользователи-наблюдатели не заходят туда **никогда**.

**1.2. Авторизация в мобильном приложении**

Здесь **другой механизм**:

1.  Пользователь вводит **только email**.
2.  Бэкенд генерирует одноразовый код и отправляет на почту.
3.  Пользователь вводит код.
4.  После успешного ввода:

- создаётся access-токен,
- мобильное приложение получает доступ к просмотру мероприятий.

**ВИ2: Просмотр списка мероприятий**

**Предусловие:**  
Администратор авторизован в системе.

**Основной сценарий:**

1.  Система отображает список ранее созданных мероприятий.
2.  Для каждого мероприятия отображаются: название, статус (черновик, опубликовано), дата изменения.
3.  Пользователь может перейти к редактированию или удалить мероприятие.

**ВИ3: Создание нового мероприятия**

**Предусловие:**  
Администратор находится в панели управления.

**Основной сценарий:**

1.  Пользователь нажимает кнопку **«Создать мероприятие»**.
2.  Система открывает форму создания.
3.  Пользователь вводит название, описание и загружает карту мероприятия (спрайт).
4.  Система сохраняет данные и создаёт пустой проект со статусом «Черновик».

**Альтернативный сценарий:**  
Если обязательные поля не заполнены, система отображает предупреждение и не сохраняет данные.

**ВИ4: Редактирование мероприятия**

**Предусловие:**  
Мероприятие создано и находится в списке.

**Основной сценарий:**

1.  Пользователь выбирает мероприятие из списка.
2.  Система открывает форму редактирования.
3.  Пользователь может изменять название, описание, расписание, интерактивные точки и контент.
4.  При сохранении система обновляет данные на сервере.

**Альтернативный сценарий:**  
Если при сохранении сервер не отвечает, система отображает сообщение об ошибке и предлагает повторить попытку.

**ВИ5: Добавление расписания (таймлайна)**

**Предусловие:**  
Администратор редактирует мероприятие.

**Основной сценарий:**

1.  Пользователь открывает раздел «Расписание».
2.  Добавляет временные точки с указанием времени начала, названия и описания события.
3.  Система сохраняет изменения в базе данных.
4.  При просмотре события на фронтенде точки таймлайна отображаются в виде вертикальной шкалы.

**ВИ6: Добавление интерактивных точек на карте**

**Предусловие:**  
Мероприятие имеет загруженную карту.

**Основной сценарий:**

1.  Пользователь выбирает инструмент «Добавить точку».
2.  На карте ставится интерактивная точка (иконка).
3.  Для точки указываются координаты, заголовок и контент (текст, фото, видео, ссылка).
4.  Система сохраняет информацию в базе данных.

**Альтернативный сценарий:**  
Если контент не добавлен, система сохраняет точку без содержимого, присваивая ей статус «пустая».

**ВИ7: Предпросмотр мероприятия**

**Предусловие:**  
Мероприятие содержит карту, расписание и контент.

**Основной сценарий:**

1.  Пользователь нажимает кнопку **«Предпросмотр»**.
2.  Система генерирует временный лендинг мероприятия с отображением всех элементов.
3.  Пользователь проверяет визуальное соответствие.

**Альтернативный сценарий:**  
Если в данных обнаружена ошибка (например, отсутствует карта), система отображает сообщение с рекомендациями.

**ВИ8: Публикация мероприятия**

**Предусловие:**  
Мероприятие полностью заполнено и прошло предпросмотр.

**Основной сценарий:**

1.  Пользователь нажимает кнопку **«Опубликовать»**.
2.  Система отправляет запрос в Backend для деплоя мероприятия.
3.  После успешного завершения публикации система присваивает мероприятию статус «Активно» и генерирует ссылку.

**Альтернативный сценарий:**  
Если деплой не удался, система информирует пользователя и сохраняет проект как «Черновик».

**ВИ9: Управление доступом к мероприятиям**

**Основной сценарий:**

1.  Администратор может включать и выключать доступность мероприятия.
2.  Недоступные мероприятия не отображаются пользователям в мобильном приложении.

**2\. Серверная часть (Backend)**

**ВИ10: Авторизация и управление пользователями**

**Основной сценарий:**

1.  Сервер принимает данные входа от фронтенда и мобильного клиента.
2.  Проверяет их в базе данных.
3.  При успешной проверке возвращает токен авторизации (JWT).

**ВИ11: CRUD-операции для мероприятий**

**Основной сценарий:**

1.  Сервер принимает запросы на создание, редактирование, удаление и получение данных мероприятий.
2.  Проверяет права доступа.
3.  Обновляет записи в базе данных.
4.  Возвращает подтверждение или ошибку.

**ВИ12: Публикация мероприятия (деплой)**

**Основной сценарий:**

1.  Сервер получает запрос на публикацию.
2.  Генерирует статическую версию мероприятия (JSON + медиафайлы).
3.  Сохраняет её на CDN/Storage.
4.  Обновляет статус мероприятия в БД на «Активно».

**ВИ13: Передача данных мобильному приложению**

**Основной сценарий:**

1.  При запросе мобильного клиента сервер формирует JSON-файл с данными мероприятия.
2.  Возвращает актуальную версию с указанием даты обновления.

**ВИ14: Уведомления**

**Основной сценарий:**

1.  Сервер отслеживает время начала событий (таймлайн).
2.  За 10 минут до начала формирует уведомление.
3.  Отправляет его через Push-сервис пользователю.

**3\. Мобильное приложение**

**ВИ15: Авторизация по коду**

**Предусловие:**  
Пользователь открывает мобильное приложение.

**Основной сценарий:**

1.  Пользователь вводит email.
2.  Система отправляет одноразовый код на почту.
3.  Пользователь вводит код.
4.  Сервер подтверждает авторизацию и предоставляет доступ к списку мероприятий.

**ВИ16: Просмотр списка мероприятий**

**Основной сценарий:**

1.  Приложение запрашивает у сервера список доступных мероприятий.
2.  Отображает только те, что имеют статус «Активно».

**ВИ17: Скачивание мероприятия**

**Основной сценарий:**

1.  Пользователь выбирает мероприятие из списка.
2.  Приложение скачивает весь контент (JSON, изображения, расписание).
3.  Сохраняет данные локально для офлайн-режима.

**ВИ18: Просмотр мероприятия**

**Основной сценарий:**

1.  Пользователь открывает мероприятие.
2.  Отображается карта с интерактивными точками и таймлайн.
3.  При клике на точку открывается модальное окно с контентом.

**ВИ19: Уведомления**

**Основной сценарий:**

1.  Приложение получает push-уведомление о начале события.
2.  При клике на уведомление открывается соответствующее мероприятие.

**ВИ20: Оффлайн-режим**

**Основной сценарий:**

1.  Если интернет недоступен, приложение отображает последнюю загруженную версию мероприятия.
2.  После восстановления сети приложение синхронизирует данные с сервером.
